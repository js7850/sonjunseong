# 차량과 컴퓨터를 연결해보자! part4
* __여호영 / 2020.07.16__

## 지난 번 이야기
CAN 케이블의 배선을 수정하는 과정에서 본인의 잘못을 찾고 고쳤다.  
같은 종류의 배선이라고 해도 모든 회사에서 같은 배선의 케이블을 만들지는 않을 수 있다는 교훈을 얻었다.  
결국 일주일이라는 시간을 날리고 CAN 연결에 성공하고 이 데이터를 가공하는 일만 남았다.  

## 데이터 처리
CAN 데이터를 받아오는 것은 성공했다. 근데 이제부터 어떻게 해야할까?  
CAN 데이터를 받아서 모니터링 하는 것까진 성공했다.  
근데 이 데이터를 사용하려면 팀원들이 사용하기 편하게 Python이나 C++에서 사용할 수 있도록 해야하는데?  
열심히 찾아본 결과 Kvaser사에서 기본적으로 지원하는 툴이 있더라.  
이 툴은 감사하게도 Python으로 설계되어 있었다.  
이 툴을 사용하면 ROS에 Publish 할 수 있고 모든 팀이 이 데이터를 사용할 수 있게 된다.  
물론 명령을 보내는 것 또한 가능하다.  
우리는 빨리 IONIQ으로부터 Python으로 데이터를 받는 프로그램을 만들었다.  

## 데이터 가공 및 ROS Publish
CAN 데이터를 가공해서 ROS에 Publish 해야하는 것은 알겠는데, 그걸 어떻게 하나?  
우선 CAN 데이터가 어떤 형식으로 구성되어 있는지 확인해야 한다.  
CAN 데이터에서 중요한 부분이라고 하면 ID, DLC, DATA가 있다.  
ID는 말 그대로 ID이며 보통 hex값이다. DLC는 데이터의 길이로 Int값이며 단위는 바이트이다.  
마지막으로 DATA는 말 그대로 DATA이며 각 ID마다 여러 DATA가 담겨있다.  
CAN에서 DATA는 보통 8바이트의 길이로 구성되어 있는데 차량의 정보를 담기에 8바이트는 너무 작기에 특정 ID에 여러 DATA가 묶여있다.  
그래서 ID가 존재하는 것이고 한 ID의 길이가 8바이트로 같아도 담고 있는 DATA의 종류의 수는 다를 수 있다.  

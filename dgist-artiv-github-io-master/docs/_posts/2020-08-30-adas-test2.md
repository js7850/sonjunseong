---
date: 2020-08-30
layout: post
title: Lane Keeping Assist Test
subtitle: Lane Keeping Assist Test
description: Lane Keeping Assist Test
image: https://user-images.githubusercontent.com/25432456/91651414-542f5100-eac7-11ea-8c2c-66eb21f90418.gif
optimized_image: https://user-images.githubusercontent.com/25432456/91651414-542f5100-eac7-11ea-8c2c-66eb21f90418.gif
category: control
tags:
  - autonomous
  - deep_learning
  - adas
  - pure_pursuit
author: hoyeong
---

> DGIST 캠퍼스내 통제된 구역안에서 자율주행모드로 진행하였습니다.


# Lane Keeping Assist의 DGIST 원내 주행

## Figure 얻을 준비
오늘은 9월 2일(사실은 0901에 시작해서 2일에 끝난 것. 늘 그렇듯이..)이다.   
곧 논문을 쓰기 위해서 오늘은 Figure를 많이 얻어야 한다...   
근데 처음 시작했을 때 우리의 상황은?   

1. 전체적인 센서가 부착되지 않았다.(카메라, GPS,...)
2. GPS를 부착 후에 Vision-Pure pursuit 알고리즘을 테스트 해본 적이 없다.
3. 최근까지 ERP만 개발했다.

모든 센서를 부착하고 첫 테스트를 시도하면서 아이오닉 개발에 다시 익숙해져야 한다.(하루만에)    
물론 일주일 동안 쉬고 왔으니 이 정도는 뭐...

## 센서 부착
우리 논문을 위한 Figure를 얻기 위해서는 카메라와 GPS는 필수이다.   
그렇게 카메라, GPS를 설치하고 테스트 하려는 도중, 당연히 될 거라 생각했던 CAN 통신에 문제가 생겼다.   
계속 네트워크가 down 됐다고 한다.
ROS Socketcan을 실행하고, 데이터 송수신 프로그램을 키면 에러가 뜬다.   
실행 순서를 거꾸로 하면 문제가 발생하지 않는다.   
하지만 통신은 언제나 연결 되어야 하고, 만약에 문제가 생기더라도 스스로 재부팅 되어야 한다.   
그렇기에 더더욱 잔오류가 없어야 한다. 그래서 ros_canopen 파일을 이리저리 살펴보았지만 해결책은 못 찾음 ㅠㅠ   
결국 필수적인 데이터를 다른 SSD에 복사 후, 해당 SSD로 부팅하였다.   
그러니 잘 된다? 생각보다 간단하게 문제가 해결되고 곧바로 다른 센서를 부착했다.   
하지만 카메라를 부착하고 테스트 중에 문제가 또 발생했다.   
뭐든지 막상 하려면 여러 문제가 겹친다. ~~이래서 제때제때 해야하는가보다~~.   
이번엔 하드웨어 문제로, 햇빛이 너무 강해서 3D 프린터로 만들어진 카메라 지지대가 뒤틀린 것이다.   
그래서 카메라를 아래로 누르게 되었고, 카메라의 시야 각도가 올바르지 않게 되었다.   
곧바로 찬영이한테 SOS, 찬영이가 바로 와서 고쳐줬다.   
이젠 되겠지...   

## 출발
다행히 모든 센서가 정상적으로 작동하며 CAN 통신도 끊기지 않게 되었다.   
기대하는 관준이를 뒤로 하고 재승(운전자), 나, 은빈, 승기가 아이오닉에 탑승한채 출발했다.   
아니나 다를까 준비는 끝났는데, 조금씩 문제가 생긴다.   
Plotting이 안 되네?... ~~(승기군...)~~ 알고보니 GPS가 튀는 거였네? ~~(미안~)~~   
다 됐으니까 경로 생성할 위치를 정해보자!

## 경로 생성
우리는 고민 끝에 세가지 위치를 결정했다.   

1. E16 옆, 오르막길
2. S1 뒤, 오르막길 (기숙사 가는 길)
3. R1 앞, 직선구간 (R7에 더 가까운)
